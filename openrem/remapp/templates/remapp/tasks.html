<table class="table sortable" id="{{ type }}" aria-describedby="Table showing running or runned tasks">
  <tr>
    <th id="uuid_{{ type }}" onclick="updateSort(this.id, 'user_click');">UUID</th>
    <th id="task_{{ type }}" onclick="updateSort(this.id, 'user_click');">Task type</th>
    <th id="info_{{ type }}" onclick="updateSort(this.id, 'user_click');">Info</th>
    <th id="error_{{ type }}" onclick="updateSort(this.id, 'user_click');">Error</th>
    <th id="started_{{ type }}" onclick="updateSort(this.id, 'user_click');">Started</th>
    <th id="state_{{ type }}" onclick="updateSort(this.id, 'user_click');">State</th>
    {% if type == 'active' %} 
      <th id="abort">Abort Task</th>
    {% endif %}
  </tr>
  {% for task in tasks %}
    <tr>
      <td>{{ task.uuid }}</td>
      <td>{{ task.task_type|safe }}</td>
      <td>{{ task.info|safe }}</td>
      <td>{{  task.error|safe }}</td>
      <td>
        {% if task.started_at is not None %}
          {{ task.started_at }}
        {% endif %}
      </td>
      {% if task.complete %} 
        {% if task.completed_successfully %} 
          <td>Success</td>
        {% else %} 
          <td>Failure</td>
        {% endif %} 
      {% else %}
        <td>
          {% if task.started_at is None %}
            Not yet started
          {% else %}
            Running
          {% endif %}
        </td>
      {% endif %}
      {% if type == 'active' %} 
        <td>
          <a class="btn btn-danger" href="{% url 'abort_task' task_id=task.uuid %}" role="button">
            Terminate task
          </a>
        </td>
      {% endif %}
    </tr>
  {% endfor %}
</table>

<script>
    $(document).ready(function () {
        var taskTable{{ type }} = document.getElementById("{{ type }}");
        sorttable.makeSortable(taskTable{{ type }});
        updateSort(sort_info_{{ type }}.heading);
    });
</script>


